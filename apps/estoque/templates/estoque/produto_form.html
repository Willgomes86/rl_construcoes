{% extends 'core/base.html' %}

{% block content %}
<style>
  .card-body, .card-body label, .card-body small,
  .card-body input, .card-body textarea, .card-body select {
    color: #f1f1f1 !important; /* texto claro */
  }

  .card-body input, .card-body textarea, .card-body select {
    background-color: #2b2b2b;
    border: 1px solid #444;
    color: #f1f1f1 !important;
  }

  .card-body input::placeholder,
  .card-body textarea::placeholder {
    color: #aaa !important;
  }

  .form-check-label {
    color: #f1f1f1 !important;
  }
</style>

<div class="container py-4">
  <h2 class="text-center mb-4" style="color:#C8A951;">
    <i class="bi bi-plus-circle" style="color:#881A15;"></i> Cadastrar Produto / Item de Estoque
  </h2>

  <div class="card mx-auto" style="max-width:1100px; background:#1e1e1e; border:1px solid #2a2a2a;">
    <div class="card-body">
      <form method="post" enctype="multipart/form-data" class="row g-3">
        {% csrf_token %}

        <!-- Identificação -->
        <div class="col-12"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-info-circle"></i> Identificação</h5><hr class="mt-0"/></div>

        <div class="col-md-6">
          <label class="form-label">Nome do produto</label>
          {{ form.nome }}
          <small class="text-muted">Nome curto para aparecer em OS/comandas.</small>
        </div>

        {% if form.marca %}<div class="col-md-3">
          <label class="form-label">Marca</label>
          {{ form.marca }}
        </div>{% endif %}

        {% if form.modelo %}<div class="col-md-3">
          <label class="form-label">Modelo</label>
          {{ form.modelo }}
        </div>{% endif %}

        {% if form.categoria %}<div class="col-md-4">
          <label class="form-label">Categoria</label>
          {{ form.categoria }}
          <small class="text-muted">Ex.: Cabos, Disjuntores, Inversores, Módulos…</small>
        </div>{% endif %}

        {% if form.unidade_medida %}<div class="col-md-2">
          <label class="form-label">Unidade</label>
          {{ form.unidade_medida }}
        </div>{% endif %}

        {% if form.descricao %}<div class="col-12">
          <label class="form-label">Descrição detalhada</label>
          {{ form.descricao }}
        </div>{% endif %}

        <!-- Códigos & Rastreabilidade -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-upc-scan"></i> Códigos & Rastreabilidade</h5><hr class="mt-0"/></div>

        {% if form.sku %}<div class="col-md-3">
          <label class="form-label">SKU / Código interno</label>
          {{ form.sku }}
        </div>{% endif %}

        {% if form.codigo_barras %}<div class="col-md-3">
          <label class="form-label">Código de barras (EAN)</label>
          {{ form.codigo_barras }}
        </div>{% endif %}

        {% if form.numero_serie %}<div class="col-md-3">
          <label class="form-label">Número de série</label>
          {{ form.numero_serie }}
        </div>{% endif %}

        {% if form.lote %}<div class="col-md-3">
          <label class="form-label">Lote</label>
          {{ form.lote }}
        </div>{% endif %}

        {% if form.validade_lote %}<div class="col-md-3">
          <label class="form-label">Validade do lote</label>
          {{ form.validade_lote }}
        </div>{% endif %}

        <!-- Estoque -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-box-seam"></i> Estoque</h5><hr class="mt-0"/></div>

        {% if form.quantidade_inicial %}<div class="col-md-3">
          <label class="form-label">Quantidade inicial</label>
          {{ form.quantidade_inicial }}
        </div>{% endif %}

        {% if form.estoque_minimo %}<div class="col-md-3">
          <label class="form-label">Estoque mínimo</label>
          {{ form.estoque_minimo }}
          <small class="text-muted">Alerta quando atingir o mínimo.</small>
        </div>{% endif %}

        {% if form.quantidade %}<div class="col-md-3">
          <label class="form-label">Quantidade atual</label>
          {{ form.quantidade }}
        </div>{% endif %}

        {% if form.localizacao %}<div class="col-md-6">
          <label class="form-label">Localização física</label>
          {{ form.localizacao }}
        </div>{% endif %}

        {% if form.ativo %}<div class="col-md-3 d-flex align-items-end">
          <div class="form-check">
            {{ form.ativo }}
            <label class="form-check-label">Ativo para uso/venda</label>
          </div>
        </div>{% endif %}

        <!-- Comercial -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-cash-coin"></i> Comercial</h5><hr class="mt-0"/></div>

        {% if form.custo %}<div class="col-md-3">
          <label class="form-label">Custo (R$)</label>
          {{ form.custo }}
        </div>{% endif %}
        {% if form.preco_venda %}<div class="col-md-3">
          <label class="form-label">Preço de venda (R$)</label>
          {{ form.preco_venda }}
        </div>{% endif %}
        {% if form.garantia_meses %}<div class="col-md-3">
          <label class="form-label">Garantia (meses)</label>
          {{ form.garantia_meses }}
        </div>{% endif %}

        <!-- Fornecedor & Aquisição -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-truck"></i> Fornecedor & Aquisição</h5><hr class="mt-0"/></div>

        {% if form.fornecedor %}<div class="col-md-4">
          <label class="form-label">Fornecedor</label>
          {{ form.fornecedor }}
        </div>{% endif %}
        {% if form.nota_fiscal %}<div class="col-md-4">
          <label class="form-label">Nota Fiscal</label>
          {{ form.nota_fiscal }}
        </div>{% endif %}
        {% if form.data_compra %}<div class="col-md-4">
          <label class="form-label">Data da compra</label>
          {{ form.data_compra }}
        </div>{% endif %}

        <!-- Elétricas / Solar -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-lightning-charge"></i> Especificações Elétricas / Solar</h5><hr class="mt-0"/></div>

        {% if form.tensao %}<div class="col-md-2"><label class="form-label">Tensão (V)</label>{{ form.tensao }}</div>{% endif %}
        {% if form.corrente %}<div class="col-md-2"><label class="form-label">Corrente (A)</label>{{ form.corrente }}</div>{% endif %}
        {% if form.potencia %}<div class="col-md-2"><label class="form-label">Potência (W)</label>{{ form.potencia }}</div>{% endif %}
        {% if form.ip %}<div class="col-md-2"><label class="form-label">Grau IP</label>{{ form.ip }}</div>{% endif %}
        {% if form.vmp %}<div class="col-md-2"><label class="form-label">Vmp (V)</label>{{ form.vmp }} <small class="text-muted">Módulo FV</small></div>{% endif %}
        {% if form.imp %}<div class="col-md-2"><label class="form-label">Imp (A)</label>{{ form.imp }} <small class="text-muted">Módulo FV</small></div>{% endif %}
        {% if form.dimensoes %}<div class="col-md-6"><label class="form-label">Dimensões (C x L x A)</label>{{ form.dimensoes }}</div>{% endif %}
        {% if form.peso %}<div class="col-md-2"><label class="form-label">Peso (kg)</label>{{ form.peso }}</div>{% endif %}

        <!-- Observações & Anexos -->
        <div class="col-12 mt-2"><h5 class="mb-2" style="color:#C8A951;"><i class="bi bi-paperclip"></i> Observações & Anexos</h5><hr class="mt-0"/></div>

        {% if form.observacoes %}<div class="col-12">
          <label class="form-label">Observações</label>
          {{ form.observacoes }}
        </div>{% endif %}

        {% if form.imagem %}<div class="col-md-6">
          <label class="form-label">Foto / Imagem</label>
          {{ form.imagem }}
        </div>{% endif %}

        {% if form.manual_pdf %}<div class="col-md-6">
          <label class="form-label">Manual / Datasheet (PDF)</label>
          {{ form.manual_pdf }}
        </div>{% endif %}

        <div class="col-12 d-flex justify-content-end gap-2 mt-2">
          <a href="{% url 'estoque:produto_list' %}" class="btn btn-secondary"><i class="bi bi-x-circle"></i> Cancelar</a>
          <button type="submit" class="btn btn-danger"><i class="bi bi-save"></i> Salvar</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
